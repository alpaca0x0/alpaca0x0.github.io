<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>Hello-World</title>
    <url>/2021/07/14/Hello-World/</url>
    <content><![CDATA[Just a test description...
<span id="more"></span>
<hr>
<h2 id="code-block">Code Block</h2>
<pre class="line-numbers language-PHP" data-language="PHP"><code class="language-PHP">&lt;?php
echo &quot;hello world !&quot;;
?&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<hr>
<h2 id="test-title">Test Title</h2>
<p>Test content.</p>
]]></content>
  </entry>
  <entry>
    <title>How to use GnuPG to generate PGP key？</title>
    <url>/2021/07/16/GPG-Generate-PGP-Key/</url>
    <content><![CDATA[怎麼使用 GnuPG 生成 PGP 金鑰？
<span id="more"></span>
<hr>
<h2 id="gnupg">GnuPG</h2>
<p><code>GNU Privacy Guard</code>  簡稱  <code>GnuPG</code> 、 <code>GPG</code> ，主要是用於數位 <code>加密</code> 、 <code>簽章</code> 的軟體。(<a href="https://zh.wikipedia.org/wiki/%E5%85%AC%E5%BC%80%E5%AF%86%E9%92%A5%E5%8A%A0%E5%AF%86"> <code>Asymmetric cryptography</code> </a> 金鑰的管理)</p>
<hr>
<h2 id="install">Install</h2>
<p>Ubuntu</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">apt-get</span> <span class="token function">install</span> gnupg2
<span class="token comment"># OR</span>
<span class="token function">apt-get</span> <span class="token function">install</span> gnupg<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>Mac</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">brew <span class="token function">install</span> gnupg<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<hr>
<h2 id="generate-a-new-keypair">Generate a new keypair</h2>
<ul>
<li>如果你想 <code>簡單快速</code> 的 <code>生成金鑰</code> ，可以使用指令：</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">gpg --gen-key<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<ul>
<li>想 <code>手動選擇</code> 更完整的選項可以使用指令：</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">gpg --full-gen-key<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<hr>
<p>如果是  <code>--full-gen-key</code>  則會顯示：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">Please <span class="token keyword">select</span> what kind of key you want:
   <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> RSA and RSA <span class="token punctuation">(</span>default<span class="token punctuation">)</span>
   <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> DSA and Elgamal
   <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> DSA <span class="token punctuation">(</span>sign only<span class="token punctuation">)</span>
   <span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> RSA <span class="token punctuation">(</span>sign only<span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token number">14</span><span class="token punctuation">)</span> Existing key from card
Your selection?<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>輸入數字選擇自己要的 <code>加密演算法類型</code> ，或者直接按下 Enter 使用預設。</p>
<p>接著是輸入 <code>金鑰的長度</code> 及 <code>金鑰時效</code> 設定：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">RSA keys may be between <span class="token number">1024</span> and <span class="token number">4096</span> bits long.
What keysize <span class="token keyword">do</span> you want? <span class="token punctuation">(</span><span class="token number">3072</span><span class="token punctuation">)</span> <span class="token comment"># 輸入金鑰位元長度，1024 ～ 4096 之間</span>
Requested keysize is <span class="token number">3072</span> bits<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">Please specify how long the key should be valid.
         <span class="token number">0</span> <span class="token operator">=</span> key does not expire
      <span class="token operator">&lt;</span>n<span class="token operator">></span>  <span class="token operator">=</span> key expires <span class="token keyword">in</span> n days
      <span class="token operator">&lt;</span>n<span class="token operator">></span>w <span class="token operator">=</span> key expires <span class="token keyword">in</span> n weeks
      <span class="token operator">&lt;</span>n<span class="token operator">></span>m <span class="token operator">=</span> key expires <span class="token keyword">in</span> n months
      <span class="token operator">&lt;</span>n<span class="token operator">></span>y <span class="token operator">=</span> key expires <span class="token keyword">in</span> n years
Key is valid for? <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment"># 選擇金鑰過期設定</span>
Key does not expire at all
Is this correct? <span class="token punctuation">(</span>y/N<span class="token punctuation">)</span> y <span class="token comment"># 輸入「y」確認</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>接著就是輸入主要的資訊了 (使用  <code>--gen-key</code>  參數會直接跳到這)</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># Terminal</span>
Real name: Alpaca0x0 <span class="token comment"># 你的名稱</span>
Email address: alpaca0x0@example.com <span class="token comment"># 你的 Email</span>
Comment: My First PGP Key. <span class="token comment"># 註釋 (使用 full-gen-key 參數才會顯示)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>最後確認資訊<br>
若有誤可以輸入「 <code>N</code> 」修改 <code>名稱</code> ，輸入「 <code>E</code> 」修改  <code>Email</code> 。</p>
<p>輸入「 <code>O</code> 」進行確認</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">You selected this <span class="token environment constant">USER</span>-ID:
    <span class="token string">"Alpaca0x0 &lt;alpaca0x0@example.com>"</span>

Change <span class="token punctuation">(</span>N<span class="token punctuation">)</span>ame, <span class="token punctuation">(</span>E<span class="token punctuation">)</span>mail, or <span class="token punctuation">(</span>O<span class="token punctuation">)</span>kay/<span class="token punctuation">(</span>Q<span class="token punctuation">)</span>uit? O<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>之後會要求你輸入密碼，可以設定也可以留空。</p>
<p>完成後會顯示該金鑰的資訊：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">pub   rsa3072 <span class="token number">2021</span>-07-16 <span class="token punctuation">[</span>SC<span class="token punctuation">]</span> <span class="token punctuation">[</span>expires: <span class="token number">2023</span>-07-16<span class="token punctuation">]</span>
      36EECBC209A936F5AF9B25A469219C5CB53AF7C3
uid                      Alpaca0x0 <span class="token operator">&lt;</span>alpaca0x0@example.com<span class="token operator">></span>
sub   rsa3072 <span class="token number">2021</span>-07-16 <span class="token punctuation">[</span>E<span class="token punctuation">]</span> <span class="token punctuation">[</span>expires: <span class="token number">2023</span>-07-16<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li>「 <code>rsa3072</code> 」指的是「 <code>RSA</code> 」算法，金鑰長度「 <code>3072</code> 」位元</li>
<li>「 <code>36EECBC209A936F5AF9B25A469219C5CB53AF7C3</code> 」就是  <code>Key ID</code></li>
</ul>
<hr>
<h2 id="show-keys">Show keys</h2>
<h3 id="show-public-keys">Show public keys</h3>
<p>要 <code>查看</code> 已有的 <code>公鑰</code> ，使用指令：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">gpg --list-public-keys
<span class="token comment"># OR</span>
gpg --list-keys
<span class="token comment"># OR</span>
gpg -k<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><code>顯示</code> 已有的 <code>公鑰</code> ：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">pub   rsa3072 <span class="token number">2021</span>-07-16 <span class="token punctuation">[</span>SC<span class="token punctuation">]</span> <span class="token punctuation">[</span>expires: <span class="token number">2023</span>-07-16<span class="token punctuation">]</span>
      36EECBC209A936F5AF9B25A469219C5CB53AF7C3
uid           <span class="token punctuation">[</span>ultimate<span class="token punctuation">]</span> Alpaca0x0 <span class="token operator">&lt;</span>alpaca0x0@example.com<span class="token operator">></span>
sub   rsa3072 <span class="token number">2021</span>-07-16 <span class="token punctuation">[</span>E<span class="token punctuation">]</span> <span class="token punctuation">[</span>expires: <span class="token number">2023</span>-07-16<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>也可以在後方加上 <code>關鍵字</code>  ( <code>名稱</code> 、 <code>Email</code> )：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># gpg --list-keys &lt;Keyword></span>
<span class="token comment"># e.g.</span>
gpg --list-keys alpaca0x0
<span class="token comment"># OR</span>
gpg --list-keys alpaca
<span class="token comment"># OR</span>
gpg --list-keys example.com<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="show-secret-keys">Show secret keys</h3>
<p><code>查看</code> 已有的 <code>私鑰</code> ，使用指令：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">gpg --list-secret-keys <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>與  <code>--list-public-keys</code>  用法類似，一樣可以加入關鍵字查詢：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># gpg --list-secret-keys &lt;Keyword></span>
<span class="token comment"># e.g.</span>
gpg --list-secret-keys alpaca0x0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<hr>
<h2 id="exporting-key">Exporting key</h2>
<h3 id="export-public-key">Export public key</h3>
<p>若要 <code>導出公鑰</code> ，則使用指令：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">gpg --export <span class="token operator">&lt;</span>Key-ID<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>但這樣導出的密鑰是  <code>binary format</code> ，所以使用參數「 <code>--armor, -a</code> 」來使其輸出為  <code>ASCII-Code format</code> 。<br>
使用「 <code>--output, -o</code> 」或者「 <code>&gt;</code> 」將輸出結果寫入檔案：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># gpg --export --armor &lt;Key-ID> > &lt;Output-File-Name></span>
<span class="token comment"># gpg --export --armor --output &lt;Output-File-Name> &lt;Key-ID></span>
<span class="token comment"># e.g.</span>
gpg --export --armor --output public_key.pub 36EECBC209A936F5AF9B25A469219C5CB53AF7C3
<span class="token comment"># OR</span>
gpg --export --armor 36EECBC209A936F5AF9B25A469219C5CB53AF7C3 <span class="token operator">></span> public_key.pub
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="export-secret-key">Export secret key</h3>
<p><code>導出私鑰</code> 使用指令：</p>
<pre class="line-numbers language-none"><code class="language-none">gpg --export-secret-keys &lt;Key-ID&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>與  <code>--export</code>  用法相同<br>
 p.s. 若是當初生成鑰匙時有輸入密碼，則導出時也需要輸入驗證。</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># e.g.</span>
gpg --export-secret-keys --armor 36EECBC209A936F5AF9B25A469219C5CB53AF7C3 <span class="token operator">></span> secret.asc<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<hr>
<h2 id="send-the-key-to-the-key-server">Send the key to the key server</h2>
<p><code>公鑰</code> 可以上傳至公開的  <code>Keyserver</code>  上讓他人能方便下載你的公鑰。<br>
上傳的指令是：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">gpg --send-keys 0x<span class="token operator">&lt;</span>Key-ID<span class="token operator">></span>
<span class="token comment"># 可以使用「--keyserver」參數指定上傳的伺服器</span>
gpg --send-keys --keyserver <span class="token operator">&lt;</span>Server<span class="token operator">></span> 0x<span class="token operator">&lt;</span>Key-ID<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>這邊要特別注意的是，大多數時候，在  <code>&lt;Key-ID&gt;</code>  的前方要加上「 <code>0x</code> 」(Hexadecimal)。</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># e.g.</span>
gpg --send-keys --keyserver pgp.mit.edu 0x36EECBC209A936F5AF9B25A469219C5CB53AF7C3
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<hr>
<h2 id="delete-key">Delete key</h2>
<p><code>刪除</code> 本地的 <code>公鑰</code> ，使用指令：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">gpg --delete-key <span class="token operator">&lt;</span>Key-ID<span class="token operator">></span>
<span class="token comment"># e.g.</span>
gpg --delete-keys 36EECBC209A936F5AF9B25A469219C5CB53AF7C3<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>但當我們執行時，會發現終端返回這則訊息：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">gpg: there is a secret key <span class="token keyword">for</span> public key <span class="token string">"36EECBC209A936F5AF9B25A469219C5CB53AF7C3"</span><span class="token operator">!</span>
gpg: use option <span class="token string">"--delete-secret-keys"</span> to delete it first.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>這是因為你還留有該 <code>公鑰</code> 的 <code>私鑰</code> ，所以先刪除 <code>私鑰</code> ，再刪除 <code>公鑰</code> ：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># Delete secret keys</span>
gpg --delete-secret-keys <span class="token operator">&lt;</span>Key-ID<span class="token operator">></span>
<span class="token comment"># Delete public keys</span>
gpg --delete-keys <span class="token operator">&lt;</span>Key-ID<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># e.g.</span>
gpg --delete-secret-keys 36EECBC209A936F5AF9B25A469219C5CB53AF7C3
gpg --delete-keys 36EECBC209A936F5AF9B25A469219C5CB53AF7C3<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>或者使用「 <code>--delete-secret-and-public-keys</code> 」一次刪除 <code>公私鑰</code> ：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># gpg --delete-secret-and-public-keys &lt;Key-ID></span>
<span class="token comment"># e.g.</span>
gpg --delete-secret-and-public-keys 36EECBC209A936F5AF9B25A469219C5CB53AF7C3<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
]]></content>
      <categories>
        <category>Tools</category>
      </categories>
      <tags>
        <tag>Cryptography</tag>
        <tag>PGP</tag>
      </tags>
  </entry>
</search>
